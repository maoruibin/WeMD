# 图片拖拽上传 PRD

## 📋 元信息

| 项目 | 内容 |
|------|------|
| **PRD 编号** | FEAT-001 |
| **编写日期** | 2024-01-13 |
| **负责人** | @your-name |
| **优先级** | P1 |
| **预期版本** | v1.1.0 |
| **当前状态** | 📝 待评审 |

---

## 🎯 背景与目标

### 用户痛点
- 当前插入图片只能通过工具栏按钮选择文件，操作繁琐
- 用户在写文章时，经常需要插入多张图片，逐个选择效率低
- 截图后需要先保存再选择，不够直接

### 目标用户
- 微信公众号运营者
- 频繁插入图片的创作者

### 目标
- 提供拖拽上传功能，提升图片插入效率 50%+
- 支持截图直接粘贴上传
- 保持现有图床功能兼容

---

## 📖 功能描述

### 用户故事
**作为** 公众号创作者
**我想要** 拖拽图片到编辑器直接上传
**以便于** 更快速地插入图片，提升写作效率

### 核心功能点
- [ ] 拖拽图片文件到编辑器区域自动上传
- [ ] 拖拽多张图片时批量上传
- [ ] 粘贴截图直接上传（Ctrl+V）
- [ ] 上传时显示进度指示
- [ ] 上传失败时提供重试选项
- [ ] 支持的格式：JPG、PNG、GIF、WebP

---

## 🎨 交互流程

### 正常流程

#### 拖拽上传
1. 用户从桌面拖拽图片文件
2. 拖拽到编辑器区域时，显示高亮提示
3. 松开鼠标，开始上传
4. 上传成功后，在光标位置插入 Markdown 图片语法
5. 预览区显示图片

#### 粘贴上传
1. 用户截图（微信截图、系统截图等）
2. 在编辑器中按 Ctrl+V（或 Cmd+V）
3. 自动上传剪贴板中的图片
4. 上传成功后插入图片语法

### 边界情况
- 拖拽非图片文件：提示"仅支持图片格式"
- 图片过大（>10MB）：提示压缩或重选
- 网络异常：显示重试按钮
- 未配置图床：引导用户先配置图床

### UI 草图

```
┌─────────────────────────────────────────────┐
│  WeMD 编辑器                                │
├─────────────────┬───────────────────────────┤
│                 │                           │
│   文件列表      │   Markdown 编辑器         │
│                 │                           │
│                 │   拖拽图片到此处上传       │
│                 │   ┌─────────────────┐    │
│                 │   │                 │    │
│                 │   │  + 虚线边框     │    │
│                 │   │                 │    │
│                 │   └─────────────────┘    │
│                 │                           │
│                 │   [预览区域]              │
│                 │                           │
└─────────────────┴───────────────────────────┘

拖拽激活状态：
┌─────────────────────────────────────────────┐
│  拖拽图片到此处上传                          │
│   ┌─────────────────────────────────────┐  │
│   │  ✓ 释放鼠标即可上传                 │  │
│   │  (微信绿色高亮背景)                  │  │
│   └─────────────────────────────────────┘  │
└─────────────────────────────────────────────┘
```

---

## ✅ 验收标准

### 功能验收
- [ ] 拖拽单张图片能正确上传并插入
- [ ] 拖拽多张图片能批量上传并插入
- [ ] 粘贴截图能正确上传并插入
- [ ] 拖拽非图片文件有正确提示
- [ ] 上传失败能显示错误并提供重试
- [ ] 上传进度有视觉反馈

### 性能要求
- [ ] 5MB 图片上传时间 < 5 秒（正常网络）
- [ ] 拖拽反馈延迟 < 100ms
- [ ] 粘贴响应延迟 < 200ms

### 兼容性要求
- [ ] Chrome 最新版
- [ ] Safari 最新版
- [ ] Edge 最新版
- [ ] Electron 桌面版

### 非功能需求
- 上传失败不阻塞编辑器其他操作
- 支持取消上传
- 上传中的图片在取消时不插入到编辑器

---

## 📊 数据埋点

| 事件名称 | 触发条件 | 参数说明 |
|----------|----------|----------|
| image_drag_upload | 用户拖拽上传图片 | file_count, total_size, success |
| image_paste_upload | 用户粘贴上传图片 | has_image, success |
| image_upload_error | 图片上传失败 | error_code, file_size |

---

## 🔗 相关文档

- [UI 设计文档](./ui-design.md)
- [技术设计文档](./tech-design.md)
- [现有图床服务](../../../../../apps/web/src/services/imageUpload/)

---

## 📝 变更记录

| 日期 | 版本 | 变更内容 | 作者 |
|------|------|----------|------|
| 2024-01-13 | 1.0 | 初始版本 | @Claude |
