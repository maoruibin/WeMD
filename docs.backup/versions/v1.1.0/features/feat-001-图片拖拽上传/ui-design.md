# 图片拖拽上传 UI 设计

## 📋 元信息

| 项目 | 内容 |
|------|------|
| **关联 PRD** | FEAT-001 |
| **编写日期** | 2024-01-13 |
| **当前状态** | 📝 草稿 |

---

## 🎨 设计稿

### 编辑器拖拽区域

```
默认状态：
┌─────────────────────────────────────────────────────────┐
│  Markdown 编辑器                                        │
│                                                         │
│  # 文章标题                                             │
│  正文内容...                                            │
│                                                         │
└─────────────────────────────────────────────────────────┘

拖拽激活状态（拖拽图片进入区域）：
┌─────────────────────────────────────────────────────────┐
│  ┌───────────────────────────────────────────────────┐ │
│  │                                                   │ │
│  │        📷 拖拽图片到此处上传                      │ │
│  │                                                   │ │
│  │        支持 JPG、PNG、GIF、WebP 格式              │ │
│  │        最多可同时拖拽 9 张图片                    │ │
│  │                                                   │ │
│  └───────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘

样式说明：
- 背景：rgba(7, 193, 96, 0.08) # 微信绿淡化
- 边框：2px 虚线，var(--ui-accent-primary)
- 圆角：var(--ui-radius-md) 12px
- 图标：居中，48px
- 文字：居中，var(--ui-text-secondary)
```

### 上传进度

```
┌─────────────────────────────────────────────────────────┐
│  图片上传中...                                          │
│                                                         │
│  ████████████████████░░░░ 75%                          │
│                                                         │
│  [取消上传]                                             │
└─────────────────────────────────────────────────────────┘

进度条样式：
- 背景：var(--ui-bg-tertiary)
- 进度：var(--ui-accent-gradient)
- 高度：4px
- 圆角：2px
```

### 上传失败

```
┌─────────────────────────────────────────────────────────┐
│  ⚠️  上传失败                                            │
│                                                         │
│  网络连接超时，请检查网络后重试                          │
│                                                         │
│  [重新上传]  [取消]                                     │
└─────────────────────────────────────────────────────────┘
```

---

## 🧩 组件复用

### 使用现有组件
- `Button` - 主要/次要按钮
- `Icon` - lucide-react 图标库

### 需新增组件

#### 1. Dropzone 组件
```
components/Editor/Dropzone/
├── index.tsx
├── Dropzone.tsx      # 拖拽区域组件
└── styles.css
```

```typescript
interface DropzoneProps {
  onDrop: (files: File[]) => void;
  onPaste: (file: File) => void;
  disabled?: boolean;
  children: React.ReactNode;
}
```

#### 2. UploadProgress 组件
```
components/Editor/UploadProgress/
├── index.tsx
├── ProgressBar.tsx
└── styles.css
```

```typescript
interface UploadProgressProps {
  progress: number;  // 0-100
  fileName: string;
  onCancel: () => void;
}
```

#### 3. UploadError 组件
```
components/Editor/UploadError/
├── index.tsx
└── styles.css
```

```typescript
interface UploadErrorProps {
  message: string;
  onRetry: () => void;
  onCancel: () => void;
}
```

---

## 🎨 样式规范

### 颜色使用

| 元素 | 颜色 | CSS 变量 |
|------|------|----------|
| 拖拽激活背景 | rgba(7, 193, 96, 0.08) | 基于微信绿 |
| 拖拽激活边框 | #07c160 | var(--ui-accent-primary) |
| 进度条 | #07c160 → #05a850 | var(--ui-accent-gradient) |
| 错误图标 | #ef4444 | 错误色 |

### 间距规范

| 元素 | 间距 | CSS 变量 |
|------|------|----------|
| 拖拽区域内边距 | 24px | var(--spacing-lg) |
| 按钮间距 | 12px | var(--spacing-md) |
| 图标与文字间距 | 16px | var(--spacing-md) |

### 动画规范

| 场景 | 动画 | 时长 |
|------|------|------|
| 拖拽激活显现 | fade-in + scale | 200ms |
| 进度条加载 | 平滑过渡 | 300ms |
| 错误提示显现 | fade-in + slide-up | 200ms |

---

## 📱 响应式

### 桌面端 (≥768px)
- 拖拽区域覆盖整个编辑器区域
- 拖拽提示图标 48px
- 文字大小 14px

### 移动端 (<768px)
- 拖拽功能降级为点击上传（移动端不支持拖拽）
- 粘贴上传功能保持可用
- 提示文字简化

---

## 🎭 状态设计

### 拖拽状态

| 状态 | 视觉表现 |
|------|----------|
| idle（空闲） | 正常编辑器外观 |
| dragging（拖拽进入） | 虚线边框 + 微信绿背景 |
| processing（处理中） | 进度条显示 |
| success（成功） | 图片插入编辑器 |
| error（失败） | 错误提示弹窗 |

### 交互反馈

| 操作 | 反馈 |
|------|------|
| 拖拽图片进入 | 边框 + 背景高亮 |
| 拖拽图片离开 | 恢复正常状态 |
| 松开鼠标 | 开始上传，显示进度 |
| 上传成功 | Toast 提示 + 插入图片 |
| 上传失败 | 错误弹窗 + 重试选项 |

---

## 🖼️ 图标使用

使用 `lucide-react` 图标库：

| 场景 | 图标 | 大小 |
|------|------|------|
| 拖拽提示 | Image / Upload | 48px |
| 上传成功 | CheckCircle | 24px |
| 上传失败 | AlertCircle | 24px |
| 关闭/取消 | X | 20px |

---

## 📝 备注

- 拖拽激活时，编辑器滚动区域应该禁用
- 拖拽区域应该在编辑器失去焦点时自动隐藏
- 粘贴上传不显示拖拽区域，直接处理
- 图片上传后自动聚焦到编辑器，方便继续编辑

---

## 🔗 相关文档

- [PRD 文档](./prd.md)
- [UI 设计规范](../../standards/ui-design-guide.md)
